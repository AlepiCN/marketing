# marketing
构建营销平台，是各个互联网公司用于拉新、促活、留存、转化的重要手段。本项目主要在于理解此类项目的系统设计及DDD架构的实现。

---

### 20241011

在权重规则下执行抽奖。

1. 执行权重规则的策略的奖池不同，所以自动装配策略时也要装配配置权重规则后的策略
2. 此时出现多个奖池，不同类型的用户会进入不同的奖池，所以需要重载获取奖品方法

### 20241012

抽奖接口+前置规则兼容+抽奖策略+实体类构建

1. 抽奖接口，提供策略ID+用户名参数（当前功能可测试到的参数，后续可能继续添加）。
   1. 查询策略，获取该策略的规则
   2. 通过规则工厂获取规则处理器并处理，当前只有两种简单的前置规则，所以处理方法就是有黑名单直接执行黑名单，没有则继续看是否有权重规则，然后处理。
   3. 执行抽奖
2. 前置规则兼容
   1. 创建规则处理接口，不同规则各自实现
   2. 创建工厂装载规则处理接口实现类。通过自定义注解扫描所有规则处理接口实现类
   3. 抽奖时可从工厂中获取需要的规则处理接口实现类
3. 抽奖策略
   1. 创建抽奖策略抽象类，统一抽奖方法
   2. 创建前置规则处理的抽象接口，创建子类实现该接口。可以创建多个以实现不同的处理，比如先执行黑名单规则，再执行权重规则等等
4. 实体类构建
   1. 就像 Spring 源码中拆解一个 Bean 对象为不同阶段一样，我们这里也把抽奖拆解为不同时间段的过程，以用于可以在各个节点添加所需的功能流程。所以就可以将`RuleActionEntity`对象在内部区分为多个阶段的对象，方便做不同的处理且减少不必要的代码。
